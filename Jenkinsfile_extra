pipeline {
    agent any

    parameters {
        choice(name: 'TEST_MODE', choices: ['1', '2', '3'], description: 'Select the test mode')
    }

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Set up environment') {
            steps {
                echo 'Setting up environment...'
            }
        }

        stage('Run Tests') {
            steps {
                script {
                    switch(params.TEST_MODE) {
                        case '1':
                            echo 'Running test mode 1...'
                            break

                        case '2':
                            echo "Running test mode 2 with backend function: ${params.BACKEND_FUNCTION}..."
                            switch(params.BACKEND_FUNCTION) {
                                case 'add':
                                    echo "Adding user with Name: ${params.USER_NAME}..."
                                    break
                                case 'update':
                                    echo "Updating user..."
                                    break
                                case 'get':
                                    echo "Getting user..."
                                    break
                            }
                            break

                        case '3':
                            echo 'Running test mode 3...'
                            break

                        default:
                            echo "Invalid test mode: ${params.TEST_MODE}"
                    }
                }
            }
        }
    }

    post {
        always {
            echo 'Tests completed.'
        }
    }
}