pipeline {
    agent any

    parameters {
        choice(name: 'TEST_MODE', choices: ['1', '2', '3'], description: 'Select the test mode')
        string(name: 'USER_ID', defaultValue: '123', description: 'User ID to be tested')
        // The BACKEND_FUNCTION and USER_NAME parameters are dynamic and controlled by the Active Choices plugin.
    }

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Set up environment') {
            steps {
                echo 'Setting up environment...'
                // Tutaj można dodać kroki do ustawienia środowiska, jeśli są wymagane.
            }
        }

        stage('Run Tests') {
            steps {
                script {
                    switch(params.TEST_MODE) {
                        case '1':
                            echo 'Running test mode 1...'
                            // Tutaj możesz dodać kroki do wykonania testów dla trybu 1.
                            break

                        case '2':
                            echo "Running test mode 2 with backend function: ${params.BACKEND_FUNCTION}..."
                            switch(params.BACKEND_FUNCTION) {
                                case 'add':
                                    echo "Adding user with ID: ${params.USER_ID} and Name: ${params.USER_NAME}..."
                                    // Tutaj możesz dodać kroki do dodania użytkownika.
                                    break
                                case 'update':
                                    echo "Updating user with ID: ${params.USER_ID}..."
                                    // Tutaj możesz dodać kroki do aktualizacji użytkownika.
                                    break
                                case 'get':
                                    echo "Getting user with ID: ${params.USER_ID}..."
                                    // Tutaj możesz dodać kroki do pobrania informacji o użytkowniku.
                                    break
                            }
                            break

                        case '3':
                            echo 'Running test mode 3...'
                            // Tutaj możesz dodać kroki do wykonania testów dla trybu 3.
                            break

                        default:
                            echo "Invalid test mode: ${params.TEST_MODE}"
                    }
                }
            }
        }
    }

    post {
        always {
            echo 'Tests completed.'
        }
    }
}